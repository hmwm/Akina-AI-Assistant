标题：项目“夜鹰”内部算法优化文档

项目背景：
夜鹰项目是XFG公司2024年启动的智能推荐引擎实验。该项目旨在结合用户行为数据与非结构化内容，实现微型向量搜索和个性化推荐。

核心模块：
1. 数据采集模块：
   - 使用自研事件捕捉器 EagleEye v2.3，每分钟抓取 12000 条用户行为事件。
   - 事件包含动作类型、时间戳、设备 ID、匿名会话向量信息（长度 256）。
2. 向量化模块：
   - 文本内容经过自研 Tokenizer Phoenix 分词器处理。
   - 每个片段生成 512 维浮点向量，存储到 pgvector 内部表 vector_store。
   - 特殊处理规则：
       a. 避免连续重复向量（Cosine 相似度  0.97 的向量只保留第一个）。
       b. 对短文本(30 tokens)进行 padding，保证向量维度一致。
3. 搜索优化：
   - 向量索引采用 IVF_PQ 索引结构，每个分区最多存 4096 个向量。
   - 检索时结合 Bloom Filter 先排除未活跃用户，减少 22% 查询延迟。
4. 元数据规范：
   - 所有片段必须包含 metadata { knowledge 夜鹰知识库v1, module 模块名 }。
   - 便于 AI 在检索时快速限定模块上下文。
5. 日志与监控：
   - 每次上传向量数据库的批量日志，存储于 vector_audit 表。
   - 异常向量（NaN 或 Inf）会被标记并发送 Slack 警告。

备注：
- 本文档内容仅用于内部测试与 RAG 知识库实验。
- 所有向量生成与上传流程严格遵循夜鹰内部标准。
